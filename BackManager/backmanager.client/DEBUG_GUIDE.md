# 开发者调试功能使用指南

## 如何确保处于开发者模式

### 1. 检查当前环境

在浏览器控制台中输入以下命令检查当前环境：

```javascript
// 检查是否为开发环境
console.log('当前环境:', import.meta.env.DEV);
console.log('当前模式:', import.meta.env.MODE);
console.log('所有环境变量:', import.meta.env);
```

**预期输出**：
- 开发环境：`当前环境: true`
- 生产环境：`当前环境: false`

### 2. 确保在开发者模式下运行

#### 方法1：使用开发命令启动
```bash
# 在项目根目录运行
npm run dev
```

#### 方法2：检查package.json中的脚本
查看`package.json`中的scripts配置：

```json
{
  "scripts": {
    "dev": "vite",
    "build": "run-p type-check \"build-only {@}\" --",
    "preview": "vite preview"
  }
}
```

#### 方法3：检查Vite配置
查看`vite.config.ts`中的环境配置，确保没有强制设置生产环境：

```typescript
export default defineConfig({
  // ... 其他配置
  // 确保没有设置 NODE_ENV=production
});
```

### 3. 环境变量说明

Vite提供的环境变量：

- `import.meta.env.DEV`：开发环境为`true`，生产环境为`false`
- `import.meta.env.PROD`：生产环境为`true`，开发环境为`false`
- `import.meta.env.MODE`：当前模式，通常为`'development'`或`'production'`

### 4. 页面加载时的环境提示

页面加载后，控制台会显示当前环境信息：

**开发环境**：
```
🔧 当前环境：开发模式
💡 调试功能已启用
📝 使用方法：在控制台输入"debug"命令切换测试数据
```

**生产环境**：
```
🔒 当前环境：生产模式
⚠️  调试功能已禁用
```

## 调试功能使用方法

### 1. 打开浏览器控制台

#### Chrome/Edge浏览器：
1. 按F12键
2. 或右键点击页面 → 检查
3. 切换到"Console"标签页

#### Firefox浏览器：
1. 按F12键
2. 或右键点击页面 → 检查元素
3. 切换到"控制台"标签页

#### Safari浏览器：
1. 开发者菜单 → 显示Web检查器
2. 切换到"控制台"标签页

### 2. 输入调试命令

在控制台中输入以下命令：

```javascript
debug()
```

**注意**：直接输入`debug()`，需要加括号，不需要加引号或分号

### 3. 查看状态提示

#### 切换到测试数据模式：
```
🔧 已切换到测试数据模式
📊 测试数据包含：
  - Pending状态记录：1条
  - Approved状态记录：1条
  - Rejected状态记录：1条
💡 再次输入"debug()"命令可切换回真实数据模式
```

#### 切换回真实数据模式：
```
🔧 已切换回真实数据模式
💡 再次输入"debug()"命令可切换到测试数据模式
```

### 4. 界面提示

除了控制台提示，页面还会显示Element Plus的消息提示：

- **切换到测试数据模式**：显示"已切换到测试数据模式"（绿色成功提示）
- **切换回真实数据模式**：显示"已切换回真实数据模式"（绿色成功提示）

## 测试数据说明

### 1. 测试数据包含的记录

预设测试数据包含3条记录，分别对应不同的审核状态：

#### Pending状态记录：
```javascript
{
  id: 'pending-1',
  userId: 'user001',
  username: '测试用户1',
  groupId: 'group001',
  groupName: '测试群组1',
  status: 'Pending',
  verificationCode: '123456',
  enteredGroup: false,
  createdAt: '2025-01-05T10:00:00.000Z',
  processedAt: null,
  processedBy: null
}
```

#### Approved状态记录：
```javascript
{
  id: 'approved-1',
  userId: 'user002',
  username: '测试用户2',
  groupId: 'group002',
  groupName: '测试群组2',
  status: 'Approved',
  verificationCode: '789012',
  enteredGroup: true,
  createdAt: '2025-01-04T10:00:00.000Z',
  processedAt: '2025-01-05T09:00:00.000Z',
  processedBy: 'admin'
}
```

#### Rejected状态记录：
```javascript
{
  id: 'rejected-1',
  userId: 'user003',
  username: '测试用户3',
  groupId: 'group003',
  groupName: '测试群组3',
  status: 'Rejected',
  verificationCode: null,
  enteredGroup: false,
  createdAt: '2025-01-03T10:00:00.000Z',
  processedAt: '2025-01-04T10:00:00.000Z',
  processedBy: 'admin'
}
```

### 2. 测试数据用途

测试数据主要用于以下场景：

1. **按钮显示测试**：
   - 验证Pending状态记录不显示"重置审核状态"和"重新生成验证码"按钮
   - 验证Approved状态记录显示"重置审核状态"和"重新生成验证码"按钮
   - 验证Rejected状态记录只显示"重置审核状态"按钮

2. **响应式布局测试**：
   - 测试不同屏幕尺寸下的按钮显示
   - 验证按钮布局是否正确换行
   - 检查调试信息是否正常显示

3. **功能逻辑测试**：
   - 测试审核通过/拒绝功能
   - 测试重置审核状态功能
   - 测试重新生成验证码功能

## 常见问题

### 1. 控制台输入"debug()"没有反应

**可能原因**：
- 当前环境为生产环境
- 调试函数未正确挂载
- 输入命令格式不正确

**解决方法**：
1. 检查控制台是否显示"🔧 当前环境：开发模式"
2. 确认输入的是`debug()`（小写，需要括号）
3. 刷新页面后重新尝试

### 2. 测试数据未显示

**可能原因**：
- 调试模式未正确切换
- fetchAuditRecords函数未正确执行
- 数据更新失败

**解决方法**：
1. 检查控制台是否显示"🔧 已切换到测试数据模式"
2. 查看是否有错误信息
3. 刷新页面后重新输入`debug()`命令

### 3. 无法切换回真实数据

**可能原因**：
- isDebugMode状态未正确更新
- fetchAuditRecords函数未正确调用
- API调用失败

**解决方法**：
1. 检查控制台是否显示"🔧 已切换回真实数据模式"
2. 查看网络请求是否正常
3. 检查后端API是否正常运行

## 安全性说明

### 1. 生产环境自动禁用

调试功能通过以下机制确保生产环境安全：

```typescript
if (import.meta.env.DEV) {
  // 调试功能代码
}
```

**生产环境行为**：
- 调试功能代码不会执行
- 控制台监听器不会被添加
- 始终使用真实API数据

### 2. 功能隔离

调试功能仅影响审核记录列表的获取：

- ✅ 不影响其他API接口
- ✅ 不影响审核操作功能
- ✅ 不影响其他页面的数据获取

### 3. 数据安全

测试数据不会影响生产环境：

- ✅ 生产环境中无法使用测试数据
- ✅ 测试数据仅存在于内存中
- ✅ 不会修改后端数据库

## 开发建议

### 1. 开发流程建议

1. **启动开发环境**：
   ```bash
   npm run dev
   ```

2. **打开浏览器控制台**：
   - 按F12键打开开发者工具
   - 切换到Console标签页

3. **检查环境信息**：
   - 查看控制台输出的环境信息
   - 确认当前为开发模式

4. **使用调试功能**：
   - 输入`debug()`命令切换测试数据
   - 测试不同状态下的按钮显示
   - 再次输入`debug()`命令切换回真实数据

5. **测试完成后**：
   - 切换回真实数据模式
   - 验证功能正常工作
   - 准备部署到生产环境

### 2. 调试最佳实践

1. **先使用测试数据**：
   - 快速验证UI布局和按钮显示
   - 测试不同状态下的交互逻辑
   - 节省API调用时间

2. **再使用真实数据**：
   - 验证API接口正常工作
   - 测试真实数据的处理逻辑
   - 确保与后端集成正确

3. **记录测试结果**：
   - 记录发现的问题
   - 记录修复的方法
   - 为后续开发提供参考

## 总结

通过以上方法，你可以确保自己处于开发者模式，并有效使用调试功能：

1. ✅ **环境检查**：使用`import.meta.env.DEV`检查当前环境
2. ✅ **启动方式**：使用`npm run dev`启动开发环境
3. ✅ **调试命令**：在控制台输入`debug()`切换测试数据
4. ✅ **状态提示**：控制台和页面都会显示状态信息
5. ✅ **安全机制**：生产环境自动禁用调试功能

使用调试功能可以大大提高开发效率，快速验证UI布局和功能逻辑，同时确保生产环境的安全性和稳定性。
